<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>マルチョウ専用 鰹相場データ</title>
    <meta name="apple-mobile-web-app-title" content="マルチョウ相場">
    <link rel="stylesheet" href="index.css?v=20260218-phase2">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- アイコン設定 -->
    <link rel="icon" type="image/png" href="marucyou_mark.png">
    <link rel="apple-touch-icon" href="marucyou_mark_white.png">
</head>

<body class="theme-dark"> <!-- デフォルトはダークモード -->
    <!-- スプラッシュ画面 -->
    <div id="splash-screen" class="splash-screen">
        <div class="splash-content">
            <img src="marucyou_mark_white.png" alt="Marucyou Logo" class="splash-logo">
            <div class="loader"></div>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="theme-switcher">
                <button class="btn-theme active" data-theme="dark">Dark</button>
                <button class="btn-theme" data-theme="light">Light</button>
                <button class="btn-theme" data-theme="ocean">Ocean</button>
            </div>
            <h1>マルチョウ専用 鰹相場データ</h1>
            <p class="description">枕崎・焼津・山川におけるサイズ別の相場推移</p>

            <div class="filter-controls">
                <button class="btn-filter" data-range="all">全期間</button>
                <button class="btn-filter active" data-range="30">1ヶ月</button>
                <button class="btn-filter" data-range="7">1週間</button>
                <button id="btn-refresh" class="btn-refresh">🔄 更新</button>
            </div>
        </header>

        <nav class="main-tabs">
            <button class="tab-item active" data-tab="summary">📋 最新相場一覧</button>
            <button class="tab-item" data-tab="charts">📈 グラフ推移</button>
            <button class="tab-item" data-tab="bid-schedule">🚢 入札予定</button>
        </nav>

        <!-- 最新一覧サマリービュー（初期表示） -->
        <div id="view-summary" class="tab-view active">
            <div id="summary-container" class="summary-grid">
                <!-- ここにJSでカードが生成されます -->
                <p>最新データを分析中...</p>
            </div>
        </div>

        <!-- グラフ表示ビュー -->
        <div id="view-charts" class="tab-view">
            <!-- (既存のグラフ表示内容) -->
            <div class="insight-section">
                <div class="insight-card">
                    <div class="insight-header">
                        <h3>🔍 相場トレンド・分析</h3>
                        <button id="btn-reload-insight" class="btn-icon" title="別の分析を表示">↻</button>
                    </div>
                    <div id="insight-content" class="insight-content">
                        <p>データを読み込み中...</p>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <!-- ...各港のグラフ... -->
                <div class="chart-card">
                    <div class="chart-header">
                        <span class="port-title">枕崎市漁業協同組合市況</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart-枕崎"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <span class="port-title">焼津魚市場市況</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart-焼津"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <span class="port-title">山川町漁業協同組合市況</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart-山川"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- 入札予定ビュー -->
        <div id="view-bid-schedule" class="tab-view">
            <div class="bid-section">
                <div id="latest-bid-container">
                    <!-- 最新の入札予定を表示 -->
                </div>

                <div class="archive-section">
                    <details>
                        <summary class="archive-summary">📁 過去の入札予定アーカイブを表示</summary>
                        <div id="archive-bid-container">
                            <!-- 過去のデータを表示 -->
                        </div>
                    </details>
                </div>
            </div>
        </div>

        <!-- 詳細表示モーダル -->
        <div id="detail-modal" class="modal-overlay">
            <div class="modal-content">
                <button id="modal-close" class="modal-close-btn">&times;</button>
                <div id="modal-body">
                    <!-- JSで詳細データが挿入されます -->
                </div>
            </div>
        </div>

        <!-- 相場メモ入力モーダル -->
        <div id="memo-modal" class="modal-overlay">
            <div class="modal-content">
                <div class="memo-modal-header">
                    <h3>📝 相場メモ</h3>
                    <span id="memo-date" class="memo-date-label"></span>
                    <span id="memo-port" data-date="" data-port=""></span>
                </div>
                <textarea id="memo-textarea" class="memo-textarea" placeholder="例：大型高。第88永盛丸の入港で水揚げ増加見込み。"
                    rows="5"></textarea>
                <div class="memo-modal-footer">
                    <button id="memo-cancel-btn" class="btn-filter">キャンセル</button>
                    <button id="memo-save-btn" class="btn-filter"
                        style="background:var(--accent-color);color:white;border-color:var(--accent-color)">保存</button>
                </div>
            </div>
        </div>

        <footer>
            <p>Data Source: 各市況データ</p>
            <p>&copy; 2026 Marucyou Skipjack Analytics</p>
        </footer>
    </div>

    <script src="dashboard.js?v=20260218-force-v6"></script>
</body>

</html>